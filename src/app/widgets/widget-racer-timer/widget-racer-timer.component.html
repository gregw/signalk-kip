<widget-host [(config)]="widgetProperties.config" [id]="widgetProperties.uuid" (configChange)="updateConfig($event)">
  <div class="racerWrapper" (click)="mode === 'display' ? null : (mode = 'display')">
    <div *ngIf="mode === 'display'" class="display-pane">
      <div class="tts" (click)="toggleMode('time-adjust')">
        {{ timeToStart }}
      </div>
      <div class="dts" (click)="toggleMode('line-adjust')">
        {{ distanceToLine }} m
      </div>
    </div>

    <div *ngIf="mode === 'time-adjust'" class="time-adjust-pane">
      <div class="tts" (click)="toggleMode('time-adjust')">
        {{ timeToStart }}
      </div>
      <div class="timer-controls">
        <button (click)="adjustStartTime(-60)">-1m</button>
        <button (click)="adjustStartTime(-1)">-1s</button>
        <input [(ngModel)]="startTime" placeholder="HH:MM:SS" size="8"/>
        <button (click)="adjustStartTime(1)">+1s</button>
        <button (click)="adjustStartTime(60)">+1m</button>
        <button (click)="sendTimerCommand('start')">Start</button>
        <button (click)="setStartTimeManually(startTime)">Start At</button>
        <button (click)="sendTimerCommand('sync')">Sync</button>
        <button (click)="sendTimerCommand('reset')">Reset</button>
      </div>
    </div>

    <div *ngIf="mode === 'line-adjust'" class="line-adjust-pane">
      <div class="dts" (click)="toggleMode('line-adjust')">
        {{ distanceToLine }} m
      </div>

      <div class="line-grid">
        <div class="line-end" *ngFor="let end of ['port', 'stb']">
          <div class="end-label">{{ end === 'port' ? 'Port End' : 'Stb End' }}</div>
          <div class="line-buttons">
            <button (click)="adjustLineEnd(end, 0, 1)">+1°</button>
            <button (click)="adjustLineEnd(end, 10, 0)">+10m</button>
            <button (click)="adjustLineEnd(end, 1, 0)">+1m</button>
            <button (click)="setLineEnd(end)">Set End</button>
            <button (click)="adjustLineEnd(end, -1, 0)">-1m</button>
            <button (click)="adjustLineEnd(end, -10, 0)">-10m</button>
            <button (click)="adjustLineEnd(end, 0, -1)">-1°</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</widget-host>
